<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LSR Video Downloader - Browser</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">

<!-- Monetag In-Page Push + Vignette -->
<script>
(function(s){
  s.dataset.zone='10519506';
  s.src='https://nap5k.com/tag.min.js';
})([document.documentElement, document.body].filter(Boolean).pop()
.appendChild(document.createElement('script')))
</script>
</head>
<body>

<!-- ================= TOP BANNER (468x60) ================= -->
<div class="ad-box center">
<script>
atOptions = {
  'key' : '3f673e5d02626eb857acc774c36f56a6',
  'format' : 'iframe',
  'height' : 60,
  'width' : 468,
  'params' : {}
};
</script>
<script src="https://www.highperformanceformat.com/3f673e5d02626eb857acc774c36f56a6/invoke.js"></script>
</div>

<!-- ================= BROWSER HEADER ================= -->
<div class="browser-header">
  <input type="text" id="urlInput" placeholder="Search or enter URL..." value="https://www.google.com">
  <button onclick="goURL()">Go</button>
  <button onclick="newTab()">+ New Tab</button>
  <button onclick="closeTab()">Close Tab</button>
</div>

<!-- ================= IFRAME ================= -->
<div class="iframe-container">
  <iframe id="browserFrame" src="https://www.google.com"></iframe>
</div>

<!-- ================= DOWNLOAD PANEL ================= -->
<div id="downloadPanel" class="download-panel" style="display:none;">
  <h3>Download This Video</h3>
  <select id="videoQuality">
    <option value="360p">360p</option>
    <option value="720p">720p</option>
    <option value="1080p">1080p</option>
    <option value="mp3">MP3 Audio</option>
  </select>
  <button class="btn blue" onclick="startDownload()">Download</button>
</div>

<!-- ================= NATIVE AD ================= -->
<div class="ad-native">
<script async="async" data-cfasync="false"
src="https://pl28566745.effectivegatecpm.com/ae3f15925d8f1944704e01860015491c/invoke.js"></script>
<div id="container-ae3f15925d8f1944704e01860015491c"></div>
</div>

<!-- ================= BOTTOM BANNER (320x50) ================= -->
<div class="ad-box center">
<script>
atOptions = {
  'key' : '2a7ac0b46ca2d6ecef70fb7f768ae8cf',
  'format' : 'iframe',
  'height' : 50,
  'width' : 320,
  'params' : {}
};
</script>
<script src="https://www.highperformanceformat.com/2a7ac0b46ca2d6ecef70fb7f768ae8cf/invoke.js"></script>
</div>

<!-- ================= ADS CORE ================= -->
<script src="ads.js"></script>

<!-- ================= BROWSER LOGIC ================= -->
<script>
let tabs = ["https://www.google.com"];
let currentTabIndex = 0;

const iframe = document.getElementById("browserFrame");
const urlInput = document.getElementById("urlInput");
const downloadPanel = document.getElementById("downloadPanel");

// Go button
function goURL(){
  let url = urlInput.value.trim();
  if(!url) return;

  if(!url.startsWith("http")) url = "https://www.google.com/search?q=" + encodeURIComponent(url);
  iframe.src = url;
  checkVideoPanel(url);
}

// New Tab
function newTab(){
  tabs.push("https://www.google.com");
  currentTabIndex = tabs.length - 1;
  iframe.src = "https://www.google.com";
  urlInput.value = "https://www.google.com";
  downloadPanel.style.display="none";
}

// Close Tab
function closeTab(){
  if(tabs.length <= 1) {
    alert("Cannot close last tab");
    return;
  }
  tabs.splice(currentTabIndex, 1);
  currentTabIndex = tabs.length - 1;
  iframe.src = tabs[currentTabIndex];
  urlInput.value = tabs[currentTabIndex];
  checkVideoPanel(tabs[currentTabIndex]);
}

// Detect video panel
function checkVideoPanel(url){
  if(url.includes("youtube.com") || url.includes("youtu.be")){
    downloadPanel.style.display="none";
  } else {
    // Show download panel only if iframe has video content (placeholder logic)
    // For demo, always show on non-YT pages
    downloadPanel.style.display="block";
  }
}

// Start download (placeholder)
function startDownload(){
  let url = iframe.src;
  let quality = document.getElementById("videoQuality").value;

  alert("Downloading:\n" + url + "\nQuality: " + quality);

  // Save history
  let history = JSON.parse(localStorage.getItem("lsr_history") || "[]");
  history.push({
    url: url,
    quality: quality,
    time: new Date().toLocaleString()
  });
  localStorage.setItem("lsr_history", JSON.stringify(history));
}
</script>

</body>
</html>
